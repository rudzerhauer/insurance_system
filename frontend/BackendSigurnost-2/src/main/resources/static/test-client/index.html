<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>SSO Test Client</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:Inter,Arial,Helvetica,sans-serif;background:#f4f7fb;margin:40px}
    .card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.06);max-width:760px;margin:auto}
    button{padding:10px 14px;border-radius:10px;border:none;background:#2563eb;color:#fff;font-weight:700;cursor:pointer}
    pre{background:#f1f5f9;padding:12px;border-radius:8px}
  </style>
</head>
<body>
  <div class="card">
    <h2>SSO Test Client</h2>
    <p>This page tests the Keycloak SSO flow via the backend.</p>
    <div style="display:flex;gap:8px;margin-bottom:12px">
      <button id="login">Login (redirect)</button>
      <button id="me">Get /api/auth/me</button>
      <button id="logout">Clear test cookies</button>
    </div>
    <div>
      <h3>Response</h3>
      <pre id="out">Not requested yet</pre>
    </div>
    <p style="color:#666;margin-top:10px">Notes: login will redirect you through the backend which starts the OIDC flow.</p>
  </div>
<script>
document.getElementById('login').onclick = function(){
  window.location.href = '/oauth2/authorization/keycloak';
}
document.getElementById('me').onclick = async function(){
  try{
    const res = await fetch('/api/auth/me', { credentials: 'include' });
    if (!res.ok) {
      document.getElementById('out').textContent = 'Not authenticated: ' + res.status;
      return;
    }
    const data = await res.json();
    document.getElementById('out').textContent = JSON.stringify(data, null, 2);
  } catch(e) { document.getElementById('out').textContent = String(e); }
}
document.getElementById('logout').onclick = function(){
  document.getElementById('out').textContent = 'To fully logout, use backend /api/auth/logout or clear cookies in your browser.';
}
</script>
</body>
</html>
